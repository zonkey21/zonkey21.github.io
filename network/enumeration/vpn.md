აქ იქნება განხილული თუ როგორ უნდა აღმოვაჩინოთ VPN-ები (Virtual Private Network).

VPN-ის მეშვეობით შესაძლოა სხვა პირადულ ქსელში შეერთდეთ ინტერნეტიდან და იმ ქსელში იმყოფებოდეთ როგორც იქ ადგილზე მყოფი ლოკალური მომხმარე. ამას ხშირად ხმარობენ კომპანიებში რომ ზოგმა ფილიალიდან იმუშაოს კომპანიაში არსებული პროგრამების გამოსაყენად ან თანამშრომელბა სახლიდან იმუშაოს ისო როგორც კომპანიაში ოყოს. ეს ყველაფერი ხდება კავშირის შიფრაციის წყალობით.

VPN-ების სახეობები შეგვიძლია დავყოთ 3 ჯგუფად:

  * **IPsec-ზე დაფუძნებული VPN-ი**: ეს მეთოდი პოპულარულია ფილიალების ქსელების მთავარი კომპანიის ქსელთან დაკავშირებისთვის. მთავარ კომპანიაში აყენებენ VPN სერვერს, ფილიალებში კი VPN კიენტს. ზოგადი მომხმარებლები ამ მეთოდს ხშირად არ ხმარობენ ოფისის LAN-ს რომ დაუკავშირდნენ იმიტომ რომ ეს მეთოდი რთულ კონფიგურირებას მოითხოვს.
  * **OpenVPN**: ეს არის ძალიან პოპულარული მეთოდი იმისთვის რომ ზოგადი მომხმარებლები ოფისი LAN-ს დაუკავშირდნენ. მომხმარებელი აყენს VPN კლიენტს იმისთვის რომ VPN სერვერს დაუკავშირდეს. ამ მეთუდის უპირატესობაა მარტივი კონფიგურირება და არ ჭირდება ადმინისტრატორის პრივილეგიები. 
  * **SSL-ზე დაფუძნებული VPN-ი**: ამ შემთხვევაში მომხმარებელს არ სჭირდება VPN კლიენტი არამედ შეუძლია იხმაროს ვებ ბრაუზერი VPN სერვერთან დასაკავშირებლად იმ პირობით თუ ვებ ბრაუზერს SSL-ის მხარდაჭერილობა აქვს.

IPsec ხმარობს ძირითადად 3 პროტოკოლს:

  * **Authentication Headers (AH)**: ზრუნავს მთლიანობის შემოწმებაზე.
  * **Encapsulating Security Payloads (ESP)**: ზრუნავს მთლიანობის შემოწმებაზე და კონფიდენციალობაზე.
  * **Internet Key Exchange (IKE)**: საბოლოო წერტილებთან პარამეტრების შესახებ თანხმობას ასრულებს და ახორციელებს Security Association-ს (SA).

IKE ახორციელებს უსაფრთხო კავშირს შემდგომი ეტაპების მიხედვით:

  * **IKE phase 1**: ამყარებს უსაფრთხო ტუნელს ორ IPsec საბოლოო წერტილთან პარამეტრებზე შეთანხმებით, როგორიცაა შIფრაციის ალგორითმი, მთლიანობის შემოწმების ალგორითმი, ავთენტიფიკაციის ტიპის, გასაღების განაწილების მექანიზმს და განმავლობას. რომ ორ მხრივი უსაფრთხო გაერთიანება შექმნას, IKE phase 1-ს შეუძლია განახორციელოს მთავარი რეჟიმი ან აგრესიული რეჟიმი. მთავარი რეჟიმი თანხმოვას ახერხებს SA-ს შესახებ 3 წყვილი მესიჯით, აგრესიული რეჟიმი კი ამ 3 მესიჯის გაცვლისას ოპერაციებს სწრაფად ატარებს.
  * **IKE phase 2**: ეს არის მონაცემების დასაცავად.
  * **IKE phase 1.5** (ან გაფართოებული ავთენტიფიკაციის ფაზა): ეს არასავალდებულოა ფაზაა და ხშირად იყენება VPN-თან დისტანცურად საკავშიროდ.

# ike-scan

ike-scan-ი ხელსაწყოა IPsec VPN სისტემების აღმოსაჩენად და ტესტირებისთვის. IPsec-ი ყველაზე გავრცელებულია LAN-ებთან შორის კავშირისთვის და აგრეთვე დისტანციურად წვოდომის VPN-ებისთვის.

ike-scan-ი მოქმედებს IKE phase 1-ის პაკეტის გაგზავნით VPN სერვერთან და შემდეგ მოსულ პასუხს ბეჭდავს.
მას შეუძლია:
  * IKE პაკეტების გაგზავნა მრავალ მისამართზე.
  * IKE პაკეტების შექმნა.
  * პასუხის დეკოდირება და დაბეჭდვა.
  * აგრესიული რეჟიმის წინასწარ გაზიარებული გასაღების გატეხვა psk-crack ხელსაწყოს წყალობით.

ანუ ike-scan-ს შეუძლია აღმოაჩინოს IKE სერვერები და IKE-ს ვერსიები რომელსაც იყენებს IPsec VPN სერვერი.
ეს ხშირად ნიშნავ VPN-ის პროდუქტის სახელი და მოდელი.

IPsec VPN-ები გარკვეულ პორტზე არ ელოდებიან კავშირის დამყარებას და ამიტო პორტ სკანირების პროცესში ისინნი არ ჩანნან, ამიტომაა საჩირო ike-scan-ი რახან იგი სწორედ აწყობილ პაკეტს აგზავნის და ელოდება პასუხს.

განვახორციელოთ ანალიზი რეზულტატის მრავალ ხახხე დაბეჭდვით (-M, multiple), აგრესიული რეჟიმით (-A, aggressive), წინასწარ გაზიარებული გასაღები (-P, pre-shared) ike-hashkey ფაილში შენახვით.

```
root@kali:~# ike-scan -M -A –Pike-hashkey 192.168.1.254
```

ჰეშის გასატეხად რომ პაროლო დაადგინოთ VPN სერვერთან დაკავშირებისთვის:
-d მიუნიშნებს ფაილს რომელშიცაა საცდელი სიტყვების სია.

```
tutashxia@kali:~# psk-crack -d wordlist.txt ike-hashkey
```

IPsec VPN სერვერის ანაბეჭდისთვის ადრე მოპოვებული payload-ის მეშვეობით:

```
root@kali:~# ike-scan -M --trans=5,2,1,2 --showbackoff 192.168.1.254
```
