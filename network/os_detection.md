# თეორია

ოპერაციული სისტემის დადგენისთვის არსებობს ორნაირი მიდგომა: აქტიურ და პასიური.
აქტიური მეთოდით, ხელსაწყო აგზავნის პაკეტს და შემდეგ მიღებული პაკეტების ანალიზს ახორიციელებს რომ დაადგინოს ოპერიციული სისტემა და ვერსია. ყოველივე ოპერაციული სისტენა სხვადასზვა მონაცემით პასუხობს. ეს მეთოდი ჩქარია მაგრამ ამავე დროს იგი რახან აქტიურია ფიქსირდება.
პასიური მეთოდი კი ნაკლებად ამყარებს კავშირს სატესტო კომპიუტერთან და ამითი იგი ნაკლებად ფიქსირდება. მაგრამ ეს ნელი პროცესია.

# პრაქტიკა

## გლობალურ ქსელში

### p0f

|   ო.ს      | იუნიქსი  |
|   მიდგომა  | პასიური  |

p0f-ს შეიუძლია ოპერიციული სისტემის პასიურად დადგენა.

```
root@kali:~# p0f
--- p0f 3.09b by Michal Zalewski <lcamtuf@coredump.cx> ---

[+] Closed 1 file descriptor.
[+] Loaded 322 signatures from '/etc/p0f/p0f.fp'.
[+] Intercepting traffic on default interface 'wlan0'.
[+] Default packet filtering configured [+VLAN].
[+] Entered main event loop.

.-[ 192.168.1.38/51276 -> 216.105.38.11/443 (syn) ]-
|
| client   = 192.168.1.38/51276
| os       = Linux 3.11 and newer
| dist     = 0
| params   = none
| raw_sig  = 4:64+0:0:1460:mss*20,10:mss,sok,ts,nop,ws:df,id+:0
|
`----
```

### xprobe2

|   ო.ს    | იუნიქსი  |
|   დაცვა  | IDS-ით UDP პაკეტების დეტექტირება 32132-ე პორტზე, ICMP request/reply-ს ბლოკირება  |

**მაგალითი:** გავიგოთ რომელ ოპერაციულ სისტემას ხმარობს 207.76.04.15

```
xprobe2 207.76.04.15
```

### nmap

|   ო.ს    | იუნიქსი ან ვინდოუსი  |
|   დაცვა  | ბანერის შეცვლა, Firewall, IDS  |

**მაგალითი:** გავიგოთ რომელ ოპერაციულ სისტემას ხმარობს 207.76.04.15

```
nmap -sS -p 139 -O -D 123.45.34.154 207.76.04.15
```

  * -SS : nmap-s ანიშნებს რომ სკანირება SYN-scan მეთოდით გააკეთოს.
  * -p: უჩვენებთ რომელ პორტზე გინდათ სკანირება, ეგ პორტე ღია უნდა იყოს!
  * -O: nmap-ს ეუნება რომ ოპერაციული სისტემა გამოიცნოს
  * -D: ანიშმებს ტყუილ IP მისამართს (123.45.34.154), ზუსტათ ეს მისამართი იქნება ჩაწერილი ლოგ ფაილებში (Firewall-ის ან სხვა), IDS-იც ამ მისამართს დაინახავს და ასე შემდეგ. იცოდეთ, რომ თქვენი რეალურიი IP მისამართიც იგზავნება.

### sprint

|   ო.ს    | იუნიქსი  |
|   დაცვა  | ბანერის შეცვლა  |

**მაგალითი:**

```
./sprint -t 134.54.38.96
```

ოპერაციულის სისტემის გამომდინარე გაცოდინებათ რომელი ექსპლოიტების გაშვება იქნება ეფექტური.

 * -t უბრძანებს რომ აქტიურ რეჯიმში იმუშაოს
 * -l უბრძანებს რომ პასიურ რეჯიმში იმუშაოს

### Netcraft

|   ო.ს    | მულტიპლატფორმული  |
|   დაცვა  | არაფერი  |

თუ ვიცით რომელ ოპერაციულ სისტემას იყენებს მსხვერპლი, შეგვიძლია რომ დავადგინოთ რომელი თავ დასხმის მეთოდები შეგვეძლება რომ გამოვიყენოთ.

საიტი http://www.netcraft.com გვაძლევს ამის საშუალებას.

## ლოკალურ ქსელში

### Passifist

|   ო.ს    | იუნიქსი  |
|   დაცვა  | host-based firewalls  |

პროგრამა passifist-ი ნახულობს სნიფინგის მეშვეობით ლოკალორ ქსელში თუ რომელი კომპიუტერს რომელი IP აქვს, MAC მისამართი, სახელი და ოპერაციული სისტემა

**მაგალითი:**

```
./passifist -I eth0 -U "provider=TXT:filename=file.txt"
```

ამ შემთხვევაში რეზულატები ჩაიწერება file.txt-ში, რახან ასე უბრძანეთ.

პროგრამის გამორთვა ხდება CTRL+C-თი.

### LanSpy

|   ო.ს    | ვინდოუსი  |
|   დაცვა  | host-based firewalls, არა საჭირო სერვისების გათიშვა  |

პროგრამა LanSpy-ი ძებნის არსებულ კომპიუტერებს ლოკალორ ქსელში და ადგენს მით IP მისამართს, MAC მისამართს, სახელს და ოპერაციულ სისტემა
