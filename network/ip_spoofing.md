# შესავალი

ბოროტმოქმედებს უკვე დიდი ხნის მოფიქრებული აქვთ, როგორ დამალონ თავიანთი ვინაობა. IP Spoofing-ი ქსელში შენიღბვის, დამალვის ერთერთი ყველაზე გავრცელებული საშუალებაა. IP Spoofing-ის საშუალებით ბოროტმოქმედს შეუძლია დაუკავშირეს დაშორებულ კომპიუტერს/სერვერს და თავი მოაჩვენოს მას, როგორც სხვა, სერვერისთვის (ან კომპიუტერისთვის) სანდო კომპიუტერი. ამ სტატიაში ჩვენ განვიხილავთ IP Spoofing-ის კოცეპციებს: რატომ არის ეს შესაძებელი (გამომწვევი მიზეზები), როგორ ხდება ეს, რისთვის გამოიყენება და რა თქმა უნდა როგორ დავიცვათ თავი ამისგან.


# ისტორია


IP Spoofing-ის კონცეფცია პირველად წარმოიშვა (განიხილებოდა) ოთხმოციან წლებში. მიუხედავად იმისა, რომ მის შესახებ ცნობილი იყო დიდი ხნით ადრე, იგი მაინც თეორიად რჩებოდა, სანამ რობერტ მორისმა, რომლის შვილმაც დაწერა პირველი "ინტერნეტ-ჭია"(ვორმი), არ აღმოაჩინა TCP/IP პროტოკოლის სისუსტე, რომელიც ცნობილია სახელით sequence prediction (მიმდევრობის განჭვრეტა). სტივენ ბელოვინმა (Stephen Bellovin) დაწვრილებით განიხილა ეს სისუსტე სტატიაში Security Problems in the TCP/IP Protocol Suite (რომელიც, სამწუხაროდ, ვერ მოვიპოვე), სადაც აღწერილია TCP/IP პროტოკოლის აგებულების პრობლემები. ჩვენთვის ცნობილ შემთხვევაში, როდესაც კევინ მიტნიკმა გატეხა Tsutomu Shimomura-ს კომპიუტერი, მან გამოიყენა IP Spoofing და sequence prediction შეტევები. მიუხედავად იმისა, რომ ამ მეთოდების პოპულარობა შემცირდა იმ სერვისების შემცირების გამო, რომელიც მათ ექვემდებარება, ეს მეთოდები დღესაც შეიძლება იქნას გამოყენებული და ადმინისტრატორები მაქსიმალურად უნდა ეცადონ თავი დაიზღვიონ ამისგან.


# ტექნიკური რეალიზაცია


იმისათვის, რომ გაიგოთ თუ როგორ ხდება ეს აუცილებელია TCP/IP პროტოკოლის სტრუკტურაში გარკვევა. ასევე ძალიან მნიშვნელოვანია header-ების სტრუქტურებისა და ქსელში ინფორმაციის მიმოცვლის გზების ცოდნა.


## Internet Protocol - IP


Internet Protocol - ეს არის ქსელური პროტოკოლი, რომელიც მუშსაობს ISO-ს ქსელური მოდელების მესამე დონეზე. ამ პროტოკოლში არ ინახება არანაირი ინფორმაცია კავშირის მდგომარეობაზე, რომელიც გამოიყენება ქსელში პაკეტების მარშრუტიზაციისთვის. ასევე, მას არ შეუძლია გვამცნოს, არის თუ არა პაკეტი მიწოდებული ადრესატამდე.


## IP Spoofing


IP-პაკეტის header-ის განხილვისას, ჩვენ ვხედავთ, რომ პირველი 12 ბაიტი (პირველი 3 ჰორიზონტალური დანაყოფი სურათზე) შეიცავს სხვადასვა სახის ინფორმაციას პაკეტის შესახებ. შემდეგი 8 ბაიტი (შემდეგი 2 დანაყოფი) შეიცავს გამგზავნისა და ადრესატის IP-ებს. სხვადასხვა პროგრამების გამოყენებით ჰაკერს ადვილად შეუძლია შეცვალოს ეს მისამართები - მაგალითად გამგზავნის IP მისამართი. ყურადღება მივაქციოთ იმას, რომ IP პროტოკოლის სპეციფიორობის გამო ყველა პაკეტი სათითაოდ, ერთმანეთისგან დამოუკიდებლად იგზავნება. ეს უნდა გავითვალისწინოთ როდესაც ჩვენ განვიხილავთ TCP პროტოკოლს.


## Transmission Control Protocol - TCP


IP პროტოკოლი შეიძლება განვიხილოთ, როგორც ISO ქსელის მოდელის 4-ე ხარისხის პროტოკოლების, რომლებსაც მიეკუთვნება TCP, გარსი ("აბალოჩკა"). IP პროტოკოლისგან გასნხვავებით TCP პროტოკოლს გააჩნია კავშირზე დამტყარებული სტრუქტურა. ეს ნიშნავს, რომ TCP კავშირის დასამყარებლად აუცილებელია სამ საფეხუროვანი ფაზის გავლა (SYN-SYN/ACK-ACK) და მხოლოდ ამის შემდეგ გახდება შესაძლებელი ინფორმაციის გადაცემა. ეს "ჯაჭვი" უზრუნველყოფს ინფორმაციის საიმდეოდ გადაცემას, რადგან გამგზავნი იღებს დასტურს მიმღებისაგან, ნებისმიერი ინფორმაციის გაგზავნის შემდეგ.


# IP Spoofing


როგორც სურათიდან ხედავთ, TCP პაკეტი ბევრად განსხვავდება IP პაკეტიდან. ყურადღება მივაქციოთ პირველ 12 ბაიტს, რომელიც შეიცავს პორტს და თანმიმდევულ ინფორმაციას. ისევე, როგორც IP პაკეტების შემთხვევაში, ჩვენ შეგვიძლია TCP პაკეტებით მანიპულირება, სხვადასხვა პროგრამების საშუალებით. ინფორმაციის გამგზავნის და მიმღების პორტები, ჩვეულებრივ დამოკიდებულია ქსელურ აპლიკაციებზე, რომლებიც არის ექსპლუატაციაში (პროგრამებზე რომლებიც უკავშირდება ინტერნეტს). IP Spoofing-ისათვის ყველაზე მნიშვნელოვანია sequence და acknowledgement ველები (სურათი #2). ამ ველების მონაცემები არის გარანტი ინფორმაციის მიწოდებისა. Sequence number - მოიცავს ამ პაკეტის პირველ ბაიტს, რომელიც მიმდინარე პაკეტის ინფორმაციის ნაწილია. Acknowledgement number - მოიცავს შემდეგი პაკეტის ნომერს. ეს დამოკიდებულება გვაძლევს საშუალებას გავარკვიოთ - იყო თუ არა ყველა პაკეტი მიწოდებული. TCP პროტოკოლი მკვეთრად განსხვავდება IP პროტოკოლისგან, რადგანაც კავშირი უფრო ყურადღებით კონტროლდება.


## TCP/IP სტრუქტურების შესაძლებლობები


ახლა, როდესაც ჩვენ წარმოდგენა გვაქვს TCP/IP პროტოკოლების შესახებ, ჩვენ შეგვიძლია განვიხილოთ შესაძლო შედეგები. აშკარაა, რომ IP header-ის შეცვლის საშუალებით, ძალიან ადვილია გამგზავნის მისამართის გაყალბება. ამ გზას ჩვენ განვიხილავთ სტატიის გაგრძელებაში.
TCP პროტოკოლის შემთხვევაში შეტევა ხდება რიცხვების (საუბარია sequence და acknowledgement number-ზე) მიმდევრობის განჭვრეტის საშუალებით, რამაც შეიძება მიგვიყვანოს "სესიის მოპარვამდა" (ამას session hijacking-ს უწოდებენ). ამ შეტევესაც განვიხილავთ სტატიის გაგრძელებაში.


## Spoofing Attacks


IP Spoofing შეტევის რამოდენიმე ვარიაცია არსებობს. მართალია ზოგიერთი მათგანი უკვე მოძველდა, მაგრამ რამოდენიმე მათგანი დღესაც დიდ საფრთხეს წარმოადგენს ქსელური უზრუნველყოფისთვის.


### Non-Blind Spoofing


შეტევის ეს გზა მოქმედებს მაშინ, როდესაც შემტევი და მსხვერპლი ერთ შიდა ქსელში ზის. შეიძება Sequence და acknowledgement ნომრების "პერეხვატის" გაკეთება. სფუფინგის ესეთ შემთხვევაში, ყველაზე დიდი საშიშროებაა "სესიის მოპარვა" . შემტევი ამახინჯებს მსხვერპლის მიერ გადაცემული პაკეტის sequence-სა და acknowledgement number-ს, ხოლო თავისი კომპიუტერიდან აგზავნის პაკეტებს სწორი sequence-ითა და acknowledgement number-ით. ამ ტექნიკის გამოყენებით შემტევს შეუძლია ავტორიზაციისთვის გვერდის ავლა (ანუ სერვერი რომელსაც უკავშირდება შემტევი, აღიქვამს მას როგორც მსხვერპლის კომპიუტერის).


### Blind Spoofing


ეს შეტევის უფრო რთული ხერხია, რადგან შემტევს არ აქვს ინფორმაცია sequence-სა და acknowledgement-ის number-ების შესახებ. ამის გამო შემტევი აგზავნიდა რამოდენიმე პაკეტს და არჩევდა sequence-სა და acknowledgement-ის number-ების სწორ ვარიანტებს. ძველ დროში ადვილი იყო sequence-სა და acknowledgement-ის რიცხვის გაგება, პაკეტების გამოკვლევის საშუალებით, მაგრამ დღესდღეობით ოპერაიული სისტემების უმეტესობა იყენებს sequence-ის რიცხვის რანდომიზირებული შერჩევას. თუ ჩვენ შევძლებთ sequence რიცხვის გაგებას, ჩვენ მაინ შევძლებთ ინფორმაციის მიმოცვალს სამიზნე კომპიუტერთან. თუ საქმეს გულისყურით მივუდგებით, ასევე შესაძლებელია ცვლილებების შეტანა მთელს სისტემაშიც კი, მაგალითად ახალი მომხმარებლის დამატება და თავდამსხმელისათვის კარის გაღება, მსხვერპლის სერვერსა თუ კომპიუტერში.


### Denial of Service Attack (DoS)


IP Spoofing-ი გამოიყენება დღესდღეობით ერთერთ ყველაზე ძნელად მოსაგერიებელ შეტევაში Denial of Service Attack (DoS). ამ შეტევის დროს შემტევს არ სჭირდება sequence და acknowledgement სწორად შევსება, მისი ერთადერთი მიზანია გამოიწვიოს მსხვერპლის გამომშვები არხის (როუტერის, მოდემის..) გადატვირთვა. იმისათვის, რომ შეტევის დრო იყოს მაქსიმალურად დიდი, შემტევი ხშირა აყალაბებს თავის IP მისამართს. როდესაც შეტევა ხდება რამოდენიმე კომპიუტერიდან (ჰოსტიდან) შეტევის თავიდან აცილება და შემომავალ-გამავალი პაკეტების გაკონტროლება ძალიან რთულდება.


# დაცვა IP-Spoofing-ისგან


ქვევით მოყვანილი იქნება რამოდენიმე საშუალება, რათა თავიდან მაქსიმალურად ავირიდოთ IP-Spoofing შეტევები:
ფილტრაცია როუტერში - შემომავალი და გამავალი პაკეტების ფილტრაცია შესანიშნავი გამოსავალია IP Spoofing-ის თავიდან ასარიდებლად. თქვენ უნდა გამოიყენოთ ACL (access control list), რომელიც ბლოკავს უცნობ IP მისამართებს. ასევე, თქვენმა როუტერმა არ უნად მიიღოს ისეთი პაკეტები, რომლების source ველი (სურათი #1) შეიცავს თქვენს შიდა ქსელში მდებარე IP მისამართს, რადგან ეს არის ცნობილი გზა ფაირვოლების გვერდის ასავლელად. ასევე უნდა ავკრძალოთ ჩვენი შიდა ქსელიდან ისეთი პაკეტების გასვლა, რომლებიც შეიცავს IP მისამართებს, რომლებიც არ ეკუთვნის თქვენს შიდა ქსელს. ეს საჭიროა თქვენს შიდა ქსელში მჯდომი კომპიუტერების დასაცავად.
დაშიფრვა და აუტენტიფიკაცია - დაშიფვრისა და აუტენტიფიკაციის გამოეყენებაც შეამცირებს IP Spoofing-ის შესაძლებლობას. ორივე მათგანი გვხვდება Ipv6 პროტოკოლში, რომელიც ხელს შეუშლის spoofing შეტევის განხორციელებას.


# დასასრული


IP Spoofing შეტევების თავიდან არიდება ძალიან ძნელი იქნება, მანამ ინტერნეტი აწყობილია TCP/IP პროტოკოლების ბაზაზე. ცოდნა იმისა, თუ რისთვის გამოიყენება IP Spoofing და რამოდენიმე ადვილი გზა თავის დაცვისა, რომელიც აღწეროლი იყო ამ სტატიაში, დაგეხმარებათ უკეთესად დაიცვათ თქვენი ქსელი მსგავსი შეტევებისგან.
